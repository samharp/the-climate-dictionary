document.addEventListener("DOMContentLoaded",(async()=>{const e=document.getElementById("sections");try{const t=await fetch("./data/dictionary.json",{cache:"reload",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const n=await t.json();e.innerHTML="",n.sections.forEach((t=>{const n=document.createElement("div");n.classList.add("section"),n.id=t.title.toLowerCase();const a=document.createElement("p");a.classList.add("h2"),a.textContent=t.title,n.appendChild(a),t.parts.forEach((e=>{const t=document.createElement("div");t.classList.add("part"),e.id&&t.setAttribute("id",e.id);const a=document.createElement("div");a.classList.add("part-content"),t.appendChild(a);const o=document.createElement("div");a.appendChild(o);const r=document.createElement("h3");if(r.classList.add("h2"),r.textContent=e.title,o.appendChild(r),e.phonetic){const t=document.createElement("p");t.classList.add("part-info"),t.textContent=e.phonetic,o.appendChild(t)}e.content.forEach((e=>{const t=document.createElement("p");t.textContent=e,a.appendChild(t)}));const i=document.createElement("div");i.classList.add("part-aside"),t.appendChild(i);const c=document.createElement("p");c.classList.add("h4"),c.textContent="Share this definition:",i.appendChild(c);const d=document.createElement("button");if(d.setAttribute("data-url","https://theclimatedictionary.com/#"+e.id),d.setAttribute("title","Share this definition"),d.innerHTML='<span>Copy link</span><svg aria-hidden="true" class="icon"><use href="#link"></use></svg>',d.classList.add("copy-url"),i.appendChild(d),e.sourceLink){const t=document.createElement("p");t.classList.add("h4"),t.textContent="Original source:",i.appendChild(t);const n=document.createElement("a");n.setAttribute("href",e.sourceLink),n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"),n.innerHTML=`${e.source}<svg aria-hidden="true" class="icon"><use href="#arrow-up-right"></use></svg>`,n.classList.add("has-icon"),i.appendChild(n)}n.appendChild(t)})),e.appendChild(n)}))}catch(e){console.error("Error loading JSON:",e)}const t=document.querySelectorAll(".copy-url");t&&t.forEach((e=>{e.addEventListener("click",(function(){const t=e.getAttribute("data-url");t?navigator.clipboard.writeText(t).then((()=>{e.classList.add("copied"),e.querySelector("span").textContent="Copied",setTimeout((function(){e.classList.remove("copied"),e.querySelector("span").textContent="Copy link"}),2e3),console.log("URL copied to clipboard:",t)})).catch((e=>{console.error("Failed to copy URL:",e)})):console.warn("No data-url attribute found.")}))}))}));const themeContainer=document.getElementById("theme-container"),storedTheme=localStorage.getItem("theme");function toggleTheme(){"light"===themeContainer.getAttribute("data-theme")?(themeContainer.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(themeContainer.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}localStorage.getItem("theme")?themeContainer.setAttribute("data-theme",storedTheme):window.matchMedia("(prefers-color-scheme)").matches&&(window.matchMedia("(prefers-color-scheme: dark)").matches?themeContainer.setAttribute("data-theme","dark"):window.matchMedia("(prefers-color-scheme: light)")&&themeContainer.setAttribute("data-theme","light"),window.matchMedia("(prefers-color-scheme: dark)").addListener((e=>{e.matches&&themeContainer.setAttribute("data-theme","dark")})),window.matchMedia("(prefers-color-scheme: light)").addListener((e=>{e.matches&&themeContainer.setAttribute("data-theme","light")})));