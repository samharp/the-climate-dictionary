document.addEventListener("DOMContentLoaded",(async()=>{const e=document.getElementById("sections");try{const t=await fetch("./data/dictionary.json",{cache:"reload",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const n=await t.json();e.innerHTML="",n.sections.forEach((t=>{const n=document.createElement("div");n.classList.add("section"),n.id=t.title.toLowerCase();const o=document.createElement("p");o.classList.add("h2"),o.textContent=t.title,n.appendChild(o),t.parts.forEach((e=>{const t=document.createElement("div");t.classList.add("part"),e.id&&t.setAttribute("id",e.id);const o=document.createElement("div");o.classList.add("part-content"),t.appendChild(o);const a=document.createElement("div");o.appendChild(a);const r=document.createElement("h3");if(r.classList.add("h2"),r.textContent=e.title,a.appendChild(r),e.phonetic){const t=document.createElement("p");t.classList.add("part-info"),t.textContent=e.phonetic,a.appendChild(t)}e.content.forEach((e=>{const t=document.createElement("p");t.textContent=e,o.appendChild(t)}));const i=document.createElement("div");i.classList.add("part-aside"),t.appendChild(i);const d=document.createElement("p");d.classList.add("h4"),d.textContent="Share this definition:",i.appendChild(d);const s=document.createElement("button");if(s.setAttribute("data-url","https://theclimatedictionary.com/#"+e.id),s.setAttribute("title","Share this definition"),s.innerHTML='<span>Copy link</span> <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 128 128" fill="none" stroke="currentColor" stroke-width="5" stroke-linecap="round" stroke-linejoin="round"><path d="M57 64a20 20 90 0 0 29 6l18-20a20 20 90 0 0-31-26L55 44" id="l"/><use href="#l"/><use href="#l" transform="rotate(180 64 64)"/></svg>',s.classList.add("copy-url"),i.appendChild(s),e.sourceLink){const t=document.createElement("p");t.classList.add("h4"),t.textContent="Original source:",i.appendChild(t);const n=document.createElement("a");n.setAttribute("href",e.sourceLink),n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"),n.innerHTML=`${e.source}<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 128 128" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" fill="none" stroke-width="5"><path d="m103 80V25H48m55 0-79 79"/></svg>`,n.classList.add("has-icon"),i.appendChild(n)}n.appendChild(t)})),e.appendChild(n)}))}catch(e){console.error("Error loading JSON:",e)}const t=document.querySelectorAll(".copy-url");t&&t.forEach((e=>{e.addEventListener("click",(function(){const t=e.getAttribute("data-url");t?navigator.clipboard.writeText(t).then((()=>{e.classList.add("copied"),e.querySelector("span").textContent="Copied",setTimeout((function(){e.classList.remove("copied"),e.querySelector("span").textContent="Copy link"}),2e3),console.log("URL copied to clipboard:",t)})).catch((e=>{console.error("Failed to copy URL:",e)})):console.warn("No data-url attribute found.")}))}))}));const themeContainer=document.getElementById("theme-container"),storedTheme=localStorage.getItem("theme");function toggleTheme(){"light"===themeContainer.getAttribute("data-theme")?(themeContainer.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(themeContainer.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}localStorage.getItem("theme")?themeContainer.setAttribute("data-theme",storedTheme):window.matchMedia("(prefers-color-scheme)").matches&&(window.matchMedia("(prefers-color-scheme: dark)").matches?themeContainer.setAttribute("data-theme","dark"):window.matchMedia("(prefers-color-scheme: light)")&&themeContainer.setAttribute("data-theme","light"),window.matchMedia("(prefers-color-scheme: dark)").addListener((e=>{e.matches&&themeContainer.setAttribute("data-theme","dark")})),window.matchMedia("(prefers-color-scheme: light)").addListener((e=>{e.matches&&themeContainer.setAttribute("data-theme","light")})));